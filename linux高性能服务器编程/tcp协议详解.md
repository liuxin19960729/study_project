## 3.8 带外数据
```
带外数据(OOB):
    1.用于通告本端发送的总要的事情
    2.外带数据比普通数据有更加高的优先级
    3.总是立即发出 不管缓冲区是否有等待发送的普通数据
    4.外带数据可以是独立的传送层连接也可以映射到普通数据的连接中


    5.在实际应用中带外数据的使用(OOB)很少使用,已知有telnet 和 ftp 等远程 非活跃的程序



tcp 利用紧急指针标志 和紧急指针两个字段给应用程序提供紧急方式

process ->kernel buffer write N个字节
         process -> kernel 紧急数据 abc 

kernel buffer
[........,a,b,c(OOB),]
 第一字节
          第N字节
                     紧急指针         


发送端一次发送多个字节的外带数据中自由最后一个字节被当做带外数据(字母C),a,b 被当成普通数据



若 buffer 太大 会被拆分层多个tcp 报文段来发送,则每个报文段都将设置成URG标志,并且他们的紧急指针太同一个位置(外带数据最后一个字节的下一个位置),但是只有一个tcp 报文真正携带外带数据



tcp 接收端 在接受到 今年估计指针标志 会检查紧急指针,根据紧急指针来确定外带数据的位置,并将他读入特殊的缓冲(特殊缓存(称为带外缓存):只有1个字节大小 )中


note:   如果上层应用没有将带外数据即时读取出来,后续外带数据会将前面缓冲区数据覆盖


TCP SO_OOBINLINE
    修改TCP 模块的默认方式 将外带数据和普通数据一样放到TCP 缓冲区中,这样应用程序读取外带数据就像读取普通数据一样读取

    


```